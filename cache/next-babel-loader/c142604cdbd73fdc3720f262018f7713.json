{"ast":null,"code":"import \"antd/lib/modal/style/css\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/button/style/css\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/form/style/css\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/input/style/css\";\nimport _Input from \"antd/lib/input\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\nimport QuickLogin from '@/components/auth';\nimport { login } from '@/utils/api';\nimport { Context } from '@/utils/global';\nimport ShowNotification from '@/utils/notification';\nexport default function Login(props) {\n  const [loading, setLoading] = React.useState(false);\n  const formRef = React.createRef();\n  const context = React.useContext(Context);\n\n  const loginOK = () => {\n    setLoading(true);\n    var {\n      username,\n      password\n    } = formRef.current.getFieldsValue(['username', 'password']);\n    login(username, password).then(r => {\n      if (ShowNotification(r)) {\n        context.callback({\n          user: r.user\n        });\n        if (!!props.callback) props.callback(true);\n      } else {\n        if (!!props.callback) props.callback(false);\n      }\n    }).finally(() => setLoading(false));\n  };\n\n  return __jsx(_Form, {\n    ref: formRef,\n    wrapperCol: {\n      span: 24\n    }\n  }, __jsx(_Form.Item, {\n    name: \"username\"\n  }, __jsx(_Input, {\n    prefix: __jsx(UserOutlined, null),\n    placeholder: \"\\u7528\\u6237\\u540D\"\n  })), __jsx(_Form.Item, {\n    name: \"password\"\n  }, __jsx(_Input.Password, {\n    prefix: __jsx(LockOutlined, null),\n    placeholder: \"\\u5BC6\\u7801\",\n    onPressEnter: loginOK\n  })), __jsx(_Form.Item, null, __jsx(QuickLogin, null)), __jsx(_Form.Item, null, __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(_Button, {\n    loading: loading\n  }, \"\\u6CE8\\u518C\")), __jsx(_Button, {\n    type: \"primary\",\n    loading: loading,\n    onClick: loginOK,\n    style: {\n      float: 'right'\n    }\n  }, \"\\u767B\\u5F55\")));\n}\nexport function LoginModal(props) {\n  return __jsx(_Modal, {\n    title: \"\\u767B\\u5F55\",\n    visible: props.show,\n    onCancel: props.onCancel,\n    footer: []\n  }, __jsx(Login, {\n    callback: props.callback\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}