{"ast":null,"code":"import \"antd/lib/modal/style/css\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/button/style/css\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/form/style/css\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/input/style/css\";\nimport _Input from \"antd/lib/input\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\nimport { login } from '@/utils/api';\nimport { Context } from '@/utils/global';\nimport ShowNotification from '@/utils/notification';\nexport default function Login(props) {\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      loading = _React$useState2[0],\n      setLoading = _React$useState2[1];\n\n  var formRef = React.createRef();\n  var context = React.useContext(Context);\n\n  var loginOK = function loginOK() {\n    setLoading(true);\n\n    var _formRef$current$getF = formRef.current.getFieldsValue(['username', 'password']),\n        username = _formRef$current$getF.username,\n        password = _formRef$current$getF.password;\n\n    login(username, password).then(function (r) {\n      if (ShowNotification(r)) {\n        context.callback({\n          user: r.user\n        });\n        if (!!props.callback) props.callback(true);\n      } else {\n        if (!!props.callback) props.callback(false);\n      }\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  };\n\n  return __jsx(_Form, {\n    ref: formRef,\n    wrapperCol: {\n      span: 24\n    }\n  }, __jsx(_Form.Item, {\n    name: \"username\"\n  }, __jsx(_Input, {\n    prefix: __jsx(UserOutlined, null),\n    placeholder: \"\\u7528\\u6237\\u540D\"\n  })), __jsx(_Form.Item, {\n    name: \"password\"\n  }, __jsx(_Input.Password, {\n    prefix: __jsx(LockOutlined, null),\n    placeholder: \"\\u5BC6\\u7801\",\n    onPressEnter: loginOK\n  })), __jsx(_Form.Item, null, __jsx(\"a\", {\n    href: \"/api/user/jump_to_qq\"\n  }, __jsx(\"img\", {\n    src: \"http://qzonestyle.gtimg.cn/qzone/vas/opensns/res/img/Connect_logo_7.png\"\n  })), __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(\"a\", {\n    target: \"_blank\",\n    style: {\n      \"float\": 'right'\n    }\n  }, \"\\u6CE8\\u518C\"))), __jsx(_Form.Item, {\n    style: {\n      textAlign: 'right'\n    }\n  }, __jsx(_Button, {\n    type: \"primary\",\n    loading: loading,\n    onClick: loginOK\n  }, \"\\u767B\\u5F55\")));\n}\nexport function LoginModal(props) {\n  return __jsx(_Modal, {\n    title: \"\\u767B\\u5F55\",\n    visible: props.show,\n    onCancel: props.onCancel,\n    footer: []\n  }, __jsx(Login, {\n    callback: props.callback\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}