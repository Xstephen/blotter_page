{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport './image.less';\n\nfunction CreateBox(props) {\n  var src = props.src,\n      _props$alt = props.alt,\n      alt = _props$alt === void 0 ? '' : _props$alt,\n      _props$title = props.title,\n      title = _props$title === void 0 ? '' : _props$title,\n      _props$initialWidth = props.initialWidth,\n      initialWidth = _props$initialWidth === void 0 ? 'unset' : _props$initialWidth,\n      _props$initialHeight = props.initialHeight,\n      initialHeight = _props$initialHeight === void 0 ? 'unset' : _props$initialHeight;\n  var body = document.body;\n  var top = window.scrollY;\n  body.style.position = 'fixed';\n  body.style.top = \"\".concat(-top, \"px\");\n  var box = document.createElement('div');\n  box.className = 'image-lightbox';\n  document.body.appendChild(box);\n  var close = document.createElement('span');\n  close.innerText = '×';\n  close.className = 'close';\n  box.appendChild(close);\n  var hint = document.createElement('span');\n  hint.innerText = '滚轮缩放图片，拖拽修改位置';\n  hint.className = 'hint';\n  box.appendChild(hint);\n  var p = document.createElement('p');\n  p.innerText = !!title ? title : alt;\n  if (!!p.innerHTML) box.appendChild(p);\n  var img = document.createElement('img');\n  img.src = src;\n  img.alt = alt;\n  img.title = title;\n  img.style.height = initialHeight;\n  img.style.width = initialWidth;\n  box.appendChild(img);\n  var ratio = img.naturalWidth / img.naturalHeight;\n  var grabbing = false;\n  var offsetX = 0;\n  var offsetY = 0;\n  var mouseX = 0;\n  var mouseY = 0;\n\n  img.onmousedown = function (e) {\n    img.ondragstart = function () {\n      return false;\n    };\n\n    img.style.cursor = 'grabbing';\n    grabbing = true;\n    mouseX = e.offsetX;\n    mouseY = e.offsetY;\n  };\n\n  img.onmousemove = function (e) {\n    if (grabbing) {\n      offsetX += e.offsetX - mouseX;\n      offsetY += e.offsetY - mouseY;\n      img.style.marginLeft = \"\".concat(offsetX, \"px\");\n      img.style.marginTop = \"\".concat(offsetY, \"px\");\n    }\n  };\n\n  img.onmouseup = function (e) {\n    img.style.cursor = 'grab';\n    grabbing = false;\n  };\n\n  img.onclick = function (e) {\n    e.stopPropagation();\n  };\n\n  var judgeWheel = function judgeWheel(e) {\n    var height = img.height - e.deltaY;\n    img.style.maxHeight = \"unset\";\n    img.style.maxWidth = \"unset\";\n    img.style.height = \"\".concat(height, \"px\");\n    img.style.width = \"\".concat(height * ratio, \"px\");\n  };\n\n  var judgeKey = function judgeKey(e) {\n    if (e.keyCode === 27) remove();\n  };\n\n  var remove = function remove() {\n    document.removeEventListener('keydown', judgeKey);\n    document.removeEventListener('mousewheel', judgeWheel);\n    box.remove();\n    body.style.position = '';\n    body.style.top = '';\n    window.scrollTo(0, top);\n  };\n\n  document.addEventListener('keydown', judgeKey);\n  document.addEventListener('mousewheel', judgeWheel);\n  box.onclick = remove;\n  close.onclose = remove;\n}\n\nexport default (function (props) {\n  var src = props.src,\n      _props$thumbnail = props.thumbnail,\n      thumbnail = _props$thumbnail === void 0 ? src : _props$thumbnail,\n      alt = props.alt,\n      title = props.title,\n      _props$height = props.height,\n      height = _props$height === void 0 ? '100%' : _props$height,\n      _props$width = props.width,\n      width = _props$width === void 0 ? '100%' : _props$width,\n      maxHeight = props.maxHeight,\n      _props$clickable = props.clickable,\n      clickable = _props$clickable === void 0 ? false : _props$clickable,\n      style = props.style;\n  return __jsx(\"div\", {\n    className: \"image-container\",\n    style: _objectSpread({\n      height: height,\n      width: width,\n      maxHeight: maxHeight,\n      cursor: clickable ? 'pointer' : 'unset'\n    }, style),\n    onClick: function onClick() {\n      if (clickable) CreateBox({\n        src: src,\n        alt: alt,\n        title: title\n      });\n    }\n  }, __jsx(\"div\", {\n    className: \"image\",\n    style: {\n      backgroundImage: \"url('\".concat(thumbnail, \"')\")\n    }\n  }));\n});\nexport var setImageLightbox = function setImageLightbox(img) {\n  var parent = img.parentElement;\n  var src = img.src,\n      alt = img.alt,\n      title = img.title;\n  parent.removeAttribute('href');\n\n  parent.onclick = function () {\n    return CreateBox({\n      src: src,\n      alt: alt,\n      title: title\n    });\n  };\n};\nexport var setSVGLightbox = function setSVGLightbox(svg) {\n  svg.style.cursor = 'pointer';\n  var content = window.btoa(svg.outerHTML).replace(/\\n/g, '');\n  var title = !!svg.getAttribute('title') ? svg.getAttribute('title') : svg.parentElement.title;\n\n  svg.onclick = function () {\n    return CreateBox({\n      src: \"data:image/svg+xml;base64,\".concat(content, \" \"),\n      title: title,\n      alt: title,\n      initialHeight: '50%'\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"module"}